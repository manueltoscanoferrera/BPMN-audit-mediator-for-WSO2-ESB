<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<xs:schema xmlns:intersae="urn:juntadeandalucia:ceice:intersae:type:v1.0.0" xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" xmlns:xs="http://www.w3.org/2001/XMLSchema" attributeFormDefault="unqualified" elementFormDefault="qualified" jaxb:extensionBindingPrefixes="xjc" jaxb:version="2.1" targetNamespace="urn:juntadeandalucia:ceice:intersae:type:v1.0.0">


	<!-- Elemento principal -->

	<xs:element name="transaccion">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="nombreTransaccion" nillable="true" type="xs:string"/>
				<xs:element minOccurs="0" name="descripcionTransaccion" type="xs:string"/>
				<xs:element name="idTransaccion" nillable="true" type="xs:string"/>
				<xs:element name="fechaInicioTransaccion" nillable="true" type="xs:dateTime"/>
				<xs:element name="fechaFinTransaccion" nillable="true" type="xs:dateTime"/>
				<xs:element name="tipoTransaccion" nillable="true" type="xs:string"/>
				<xs:element name="estado" nillable="true" type="xs:string"/>
				<xs:element minOccurs="0" name="codigoError" type="xs:string"/>
				<xs:element minOccurs="0" name="mensajeError" type="xs:string"/>
				<xs:element minOccurs="0" name="detalleError" type="xs:string"/>
				<xs:element minOccurs="0" name="variables" type="intersae:VariablesType">
				</xs:element>
				<xs:element minOccurs="0" name="detalleTransaccion">
					<xs:complexType>
						<xs:choice>
							<xs:element maxOccurs="1" minOccurs="0" name="detalleTransaccionProxy" type="intersae:DetalleTransaccionProxyType">
							</xs:element>
							<xs:element maxOccurs="1" minOccurs="0" name="detalleTransaccionTask" type="intersae:DetalleTransaccionTaskType">
							</xs:element>				
						</xs:choice>
					</xs:complexType>
				</xs:element>
				<xs:element minOccurs="0" name="procesos">
					<xs:complexType>
						<xs:sequence>
							<xs:element maxOccurs="unbounded" minOccurs="0" name="proceso" type="intersae:ProcesoType">
							</xs:element>
						</xs:sequence>
					</xs:complexType>
				</xs:element>

			</xs:sequence>
			<xs:attribute name="version" type="xs:int"/>
		</xs:complexType>
	</xs:element>

	<xs:complexType name="DetalleTransaccionProxyType">
		<xs:sequence>
			<xs:element name="nombreProxy" nillable="true" type="xs:string"/>
			<xs:element name="ipCliente" nillable="true" type="xs:string"/>
			<xs:element name="hostCliente" nillable="true" type="xs:string"/>
			<xs:element name="idMensaje" nillable="true" type="xs:string"/>
			<xs:element name="mensajeFormato" nillable="true" type="xs:string"/>
			<xs:element name="mensajePeticion" nillable="true" type="xs:string"/>
			<xs:element name="mensajeRespuesta" nillable="true" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>
	
	<xs:complexType name="DetalleTransaccionTaskType">
		<xs:sequence>
			<xs:element name="nombreTask" nillable="true" type="xs:string"/>
			<xs:element minOccurs="0" name="mensajePeticion" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>



	<!-- Definición procesos -->

	<xs:complexType name="ProcesoType">
		<xs:sequence>
			<xs:element name="nombreProceso" nillable="true" type="xs:string"/>
			<xs:element minOccurs="0" name="descripcionProceso" type="xs:string"/>
			<xs:element minOccurs="0" name="sistemaOrigen" type="xs:string"/>
			<xs:element name="fechaInicioProceso" nillable="true" type="xs:dateTime"/>
			<xs:element name="fechaFinProceso" nillable="true" type="xs:dateTime"/>
			<xs:element name="tipoProceso" nillable="true" type="xs:string"/>
			<xs:element name="estado" nillable="true" type="xs:string"/>
			<xs:element minOccurs="0" name="codigoError" type="xs:string"/>
			<xs:element minOccurs="0" name="mensajeError" type="xs:string"/>
			<xs:element minOccurs="0" name="detalleError" type="xs:string"/>
			<xs:element minOccurs="0" name="variables" type="intersae:VariablesType">
			</xs:element>
			<xs:element minOccurs="0" name="detalleProceso" type="intersae:DetalleProcesoType">
			</xs:element>
		</xs:sequence>
		<xs:attribute name="id" type="xs:string"/>
	</xs:complexType>


	<!-- Por cada tipo de proceso soportado, que incluya campos específicos 
		añadir su definición al choice -->

	<xs:complexType name="DetalleProcesoType">
		<xs:choice>
			<xs:element maxOccurs="1" minOccurs="0" name="detalleProcesoInvocacionServicioExterno" type="intersae:DetalleProcesoInvocacionServicioExternoType">
			</xs:element>
			<xs:element maxOccurs="1" minOccurs="0" name="detalleProcesoJMS" type="intersae:DetalleProcesoJMSType">
			</xs:element>			
			
			
		</xs:choice>
	</xs:complexType>


	<!-- <xs:element name="DetalleProcesoInvocacionServicioExterno" type="intersae:DetalleProcesoInvocacionServicioExternoType"></xs:element> -->
	<xs:complexType name="DetalleProcesoInvocacionServicioExternoType">
		<xs:sequence>
			<xs:element name="nombreServicio" nillable="true" type="xs:string"/>
			<xs:element name="endpointServicio" nillable="true" type="xs:string"/>
			<xs:element name="idMensaje" nillable="true" type="xs:string"/>
			<xs:element name="mensajePeticion" nillable="true" type="xs:string"/>
			<xs:element name="mensajeRespuesta" nillable="true" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>
	
	
	<xs:complexType name="DetalleProcesoJMSType">
		<xs:sequence>
			<xs:element name="nombreColaTopic" nillable="true" type="xs:string"/>
			<xs:element name="endpointJMS" nillable="true" type="xs:string"/>
			<xs:element name="tipo" nillable="true" type="xs:string"/>
      <!-- cola o topic -->
			<xs:element name="modo" nillable="true" type="xs:string"/>
      <!-- cosumidor/producto -->
			<xs:element name="idMensaje" nillable="true" type="xs:string"/>
			<xs:element name="mensaje" nillable="true" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>
	

	<!-- Campos de variables para que las transacciones o processo puedan guardar 
		datos propios -->
	<xs:complexType name="VariablesType">
		<xs:sequence>
			<xs:element maxOccurs="unbounded" minOccurs="0" name="variable" type="intersae:VariableType"/>
		</xs:sequence>
	</xs:complexType>

	<!-- <xs:element name="Variable" type="intersae:VariableType"></xs:element> 
		- -->

	<xs:complexType name="VariableType">
		<xs:simpleContent>
			<xs:extension base="xs:string">
				<xs:attribute name="nombre" type="xs:string"/>
			</xs:extension>
		</xs:simpleContent>
	</xs:complexType>


</xs:schema>
